/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    id 'buildlogic.java-library-conventions'
    id 'buildlogic.java-spring-conventions'

    // TODO move these to the spring conventions....
    id 'org.springframework.boot'
    id 'io.spring.dependency-management'

    // TODO move to java conventions...
    id 'io.freefair.lombok'
}

ext {
//   set('snippetsDir', file("build/generated-snippets"))
//   set('springAiVersion', "1.0.0-M6")
  set('springCloudVersion', "2024.0.1")     // TODO move to spring convention
}

// configurations {
//     all {
//         exclude group: 'org.springframework.boot', module: 'spring-boot-starter-logging'
//         // exclude group: 'ch.qos.logback', module: 'logback-classic'
//         exclude group: 'org.apache.logging.log4j', module: 'log4j-to-slf4j'
//     }
// }

dependencies {
    // implementation "org.springframework.boot:spring-boot-starter-log4j2"
	// modules {
	// 	module( "org.springframework.boot:spring-boot-starter-logging" ) {
	// 		replacedBy("org.springframework.boot:spring-boot-starter-log4j2", "Use Log4j2 instead of Logback")
	// 	}
	// }

    // TODO move to spring convention
    // implementation 'org.springframework.boot:spring-boot-starter-actuator'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-validation'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation "org.springframework.boot:spring-boot-starter-logging"

    // implementation( 'org.springframework.boot:spring-boot-starter-log4j2' )
    // implementation( 'org.springframework.boot:spring-boot-starter-log4j2' ) {
    //     // implementation( 'org.springframework.boot:spring-boot-starter-logging' )
    //     exclude  group: 'org.springframework.boot', module:  'spring-boot-starter-logging'
    // }

    // --- Annotation Processor
    implementation( "jakarta.annotation:jakarta.annotation-api:3.0.0" )

    // ----- Frameworks -----
    // --- Logging
    // implementation( "org.apache.logging.log4j:log4j-core:${log4jVersion}" )
    // implementation( "org.apache.logging.log4j:log4j-api:${log4jVersion}" )
    // --- Data format / validation
    //   - needed for yaml configuration of log4j2
    implementation( "com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:${jacksonDatabindVersion}" )
    implementation( "com.fasterxml.jackson.core:jackson-databind:${jacksonDatabindVersion}" )

    // ----- Quality Assurance -----
    // --- Unit Testing
    testImplementation( "io.github.hakky54:logcaptor:${logcaptorVersion}" )

    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

bootJar {
    // Not sure yet why this is relevant for a library
    mainClass = 'com.example.YourApplication'
    // archiveFileName = 'custom-app-name.jar'
}
